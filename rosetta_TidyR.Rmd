---
title: "pandas (R)osetta: Tidyverse R"
subtitle: "Intro to R and Tidyverse for Pandas users and vice versa."
author: "Lisa Malins"
knit: (function(inputFile, encoding) {
    rmarkdown::render(
      inputFile,
      encoding = encoding,
      output_dir = "output",
      output_format = "all")
    })
output:
  github_document:
    toc: true
  html_document:
    toc: true
    toc_float: true
    df_print: paged
  pdf_document:
    toc: true
    toc_depth: 4
    df_print: "tibble"
---

&nbsp;

This is a demonstration of basic data wrangling operations in Tidyverse R.

Sister notebooks demonstrate the exact same operations in base R and the Pandas library in Python, just like the Rosetta Stone.

## I/O
### Create dataframe from scratch
```{r}
suppressPackageStartupMessages(library("dplyr"))
tbl <- tibble(
  letter = c("a", "b", "c", "d", "e"),
  number = c(1:5),
  fruit = c("apple", "banana", "coconut", "date", "elderberry"),
  vegetable = c("arugula", "beet", "carrot", "daikon", "eggplant"),
  name = c("Alice", "Bob", "Carol", "Dan", "Eve")
)
tbl
```

### Write
```{r}
library("readr")
write_csv(tbl, "data/tidy_letters.csv")
write_tsv(tbl, "data/tidy_letters.tsv")
```

### Read
```{r}
library("readr")
read_csv("data/tidy_letters.csv")
read_tsv("data/tidy_letters.tsv")
```

## Accessing data
Note for Pandas users:

- Both R and Pandas have the same convention of `[row, column]` for retrieving a cell from a dataframe.
- However, if only one number is specified with no comma, in pandas a row is returned, but in R a column is returned.
- Also, remember that **R has 1-based indexing** while Python has 0-based indexing.
- Thus,
  - In pandas: `df.iloc[1]` returns the second row
  - In R: `df[1]` returns the first column

### Select cell
To **select a single cell**, **use double brackets** with the row number, followed by the column number or column name.

```{r, results="hold"}
# Get "banana" cell value
tbl[[2, 3]]
tbl[[2, "fruit"]]
```

Cells can also be selected with single brackets. **Tibbles** (the Tidyverse version of dataframes) actually have different behavior for single brackets than dataframes in base R.

- When using single brackets to select a single cell of a dataframe, the value itself is returned.
- When using single brackets to select a single cell of a tibble, a 1x1 tibble is returned. The behavior of tibbles is more consistent with R behavior generally, because single brackets usually return an object of the same type.

```{r, results="hold"}
# Get "banana" cell as 1x1 tibble
tbl[2, 3]
tbl[2, "fruit"]
```

The bracket notation is the most common method of selecting a single cell, even in Tidyverse workflows.

That being said, there are `dplyr` functions that do the same thing, and can be useful for chaining when a single cell is the end goal, but other `dplyr` operations need to be done first.

- `select` returns one or more columns (as a dataframe)
- `pull` returns a single column as a vector
- `slice` returns a row

```{r, results="hold"}
# Get "banana" cell value
tbl %>% slice(2) %>% pull("fruit")
tbl %>% slice(2) %>% pull(3)
```

```{r, results="hold"}
# Get "banana" cell as 1x1 tibble
tbl %>% select("fruit") %>% slice(2)
tbl %>% select(3) %>% slice(2)
```
